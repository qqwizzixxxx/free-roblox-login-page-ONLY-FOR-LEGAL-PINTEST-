!function(){"use strict";var n={n:function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},d:function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},pe=React,fe=n.n(pe),t=ReactDOM,be=CoreUtilities,e=PropTypes,o=n.n(e),s=ReactUtilities,T=ReactStyleGuide,l={purchasingResources:{common:[],feature:"Purchasing.PurchaseDialog"},itemResources:{common:[],feature:"Feature.Item"},itemModelResources:{common:[],feature:"Feature.ItemModel"}},a={errorTypeIds:{transactionFailure:"TransactionFailureView",insufficientFunds:"InsufficientFundsView",priceChanged:"PriceChangedView",pendingProductsLimitExceeded:"PendingProductsLimitExceeded"},errorStatusText:{badRequest:"Bad Request"},events:{startItemPurchase:"ItemPurchaseStart",NEW_UPSELL_FAILED_DUE_TO_ERROR:"ReactBuyButtonNewUpsellProcessFailedDueToError",NEW_UPSELL_FAILED_DUE_TO_LOADING:"ReactBuyButtonNewUpsellProcessFailedDueToNotLoaded",NEW_UPSELL_FROM_REACT_BUY_BUTTON:"ReactBuyButtonNewUpsellProcessNewUpsellFromReactBuyButton"},resources:{freeLabel:"Label.Free",okAction:"Action.Ok",insufficientFundsHeading:"Heading.InsufficientFunds",insufficientFundsMessage:"Message.InsufficientFunds",doneAction:"Action.Done",cancelAction:"Action.Cancel",buyRobuxAction:"Action.BuyRobux",buyAccessAction:"Action.BuyAccess",buyItemHeading:"Heading.BuyItem",buyNowAction:"Action.BuyNow",getItemHeading:"Heading.GetItem",getNowAction:"Action.GetNow",priceChangedHeading:"Heading.PriceChanged",priceChangedMessage:"Message.PriceChanged",balanceAfterMessage:"Message.BalanceAfter",agreeAndPayLabel:"Label.AgreeAndPay",promptGetFreeAccessMessage:"Message.PromptGetFreeAccess",promptGetFreeMessage:"Message.PromptGetFree",promptBuyAccessMessage:"Message.PromptBuyAccess",promptBuyMessage:"Message.PromptBuy",configureAction:"Action.Customize",notNowAction:"Action.NotNow",customizeAction:"Action.Customize",continueAction:"Action.Continue",purchaseCompleteHeading:"Heading.PurchaseComplete",successfullyBoughtAccessMessage:"Message.SuccessfullyBoughtAccess",successfullyBoughtMessage:"Message.SuccessfullyBought",successfullyRenewedAccessMessage:"Message.SuccessfullyRenewedAccess",successfullyRenewedMessage:"Message.SuccessfullyRenewed",successfullyAcquiredAccessMessage:"Message.SuccessfullyAcquiredAccess",successfullyAcquiredMessage:"Message.SuccessfullyAcquired",itemGrantDelayMessage:"Message.ItemGrantDelay",errorOccuredHeading:"Heading.ErrorOccured",purchasingUnavailableMessage:"Message.PurchasingUnavailable",buyAction:"Action.Buy",installAction:"Action.Install",getAction:"Action.Get",bestPriceLabel:"Label.BestPrice",priceLabel:"Label.Price",premiumDiscountOpportunityPromptLabel:"Label.PremiumDiscountOpportunityPrompt",premiumDiscountSavingsLabel:"Label.PremiumDiscountSavings",premiumExclusiveEligiblePromptLabel:"Label.PremiumExclusiveEligiblePrompt",premiumExclusiveIneligiblePromptLabel:"Label.PremiumExclusiveIneligiblePrompt",getPremiumAction:"Action.GetPremium",itemNotCurrentlyForSaleLabel:"Label.ItemNotCurrentlyForSale",itemNoLongerForSaleLabel:"Label.ItemNoLongerForSale",purchasingTemporarilyUnavailableLabel:"Label.PurchasingTemporarilyUnavailable",itemAvailableInventoryLabel:"Label.ItemAvailableInventory",noOneCurrentlySellingLabel:"Label.NoOneCurrentlySelling",inventoryAction:"Action.Inventory",OffsaleCountdownHourMinuteSecondLabel:"Label.OffsaleCountdownHourMinuteSecond",CountdownTimerDayHourMinute:"Label.CountdownTimerDayHourMinute",batchBuyItemHeading:"Heading.BuyItems",batchBuyPromptMessage:"Message.PromptBatchBuy",batchBuyBalanceAfterMessage:"Message.BalanceAfter",purchaseCompletedMessage:"Heading.PurchaseCompleted",generalPurchaseErrorMessage:"Heading.GeneralError",batchBuyPartialSuccessGeneralFailureMessage:"Heading.PartialSuccessGeneralFailure",batchBuyPartialSuccessItemsOwnedFailureMessage:"Heading.PartialSuccessItemsOwnedFailure",batchBuyPartialSuccessInsufficientFundsFailureMessage:"Heading.PartialSuccessInsufficientFundsFailure",batchBuyPartialSuccessNetworkErrorFailureMessage:"Heading.PartialSuccessNetworkErrorFailure",batchBuyPartialSuccessFloodcheckFailureMessage:"Heading.PartialSuccessFloodcheckFailure",purchaseErrorFailureMessage:"Heading.PurchaseFailure",batchBuyItemsOwnedFailureMessage:"Heading.ItemsOwnedFailure",insufficientFundsFailureMessage:"Heading.InsufficientFundsFailure",networkErrroFailureMessage:"Heading.NetworkErrorFailure",floodcheckFailureMessage:"Heading.FloodcheckFailure",batchBuyPartialSuccessPremiumNeededFailureMessage:"Heading.PartialSuccessPremiumNeededFailure",batchBuyPartialSuccessNoSellersFailureMessage:"Heading.PartialSuccessNoSellersFailure",premiumNeededFailureMessage:"Heading.PremiumNeededFailure",noSellersFailureMessage:"Heading.NoSellersFailure",batchBuyPartialSuccessInExperienceOnlyFailureMessage:"Heading.PartialSuccessInExperienceOnlyFailure",inExperienceOnlyFailureMessage:"Heading.InExperienceOnlyFailure",redirectToPartnerWebsiteMessage:"Description.RedirectToPartnerWebsite",continueToPaymentAction:"Action.ContinueToPayment",leavingRobloxHeading:"Heading.LeavingRoblox",pendingDeveloperProductLimitReachedMessage:"Message.PendingDeveloperProductLimitReached",pendingDeveloperProductLimitReachedHeading:"Heading.PendingDeveloperProductLimitReached"},assetTypes:{Plugin:38,Decal:13,Model:10,Video:62,MeshPart:40,Place:9,Badge:21,GamePass:34,Animation:24},assetCategory:{Catalog:0,Library:1},purchaseMetadataKeys:{LookId:"lookId"},errorMessages:{insufficientFunds:"InsufficientFunds",retryErrorMessage:"Failed to determine purchasability status. Please try again by refreshing.",notForSale:"NotForSale",unauthorizedMessage:"Unauthorized",twoStepVerificationRequired:"TwoStepVerificationRequired"},batchBuyMaxThumbnails:3,maxBatchLoadRetries:5,floodcheckTime:5};function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c=a.resources;function u(){var e=r((0,T.createModal)(),2),a=e[0],e=e[1];function t(e){var t=e.translate,r=e.title,n=e.message,e=e.onDecline,n=fe().createElement("div",{className:"modal-message"},n);return fe().createElement(a,{title:r,body:n,thumbnail:fe().createElement("span",{className:"icon-warning-orange-150x150"}),neutralButtonText:t(c.okAction),onNeutral:e})}return t.defaultProps={onDecline:null},t.propTypes={translate:o().func.isRequired,title:o().string.isRequired,message:o().string.isRequired,onDecline:o().func},[(0,s.withTranslations)(t,l.purchasingResources),e]}var w=ReactDOMServer,P=CoreRobloxUtilities,ye=Roblox,d=ye.EnvironmentUrls.economyApi,m=ye.EnvironmentUrls.catalogApi,p=ye.EnvironmentUrls.apiGatewayUrl,f=ye.EnvironmentUrls.twoStepVerificationApi,b=ye.EnvironmentUrls.universalAppConfigurationApi,y=ye.EnvironmentUrls.vngGamesShopUrl,x={getRobuxUpgradesUrl:function(e){return be.urlService.getUrlWithQueries("/Upgrades/Robux.aspx",{ctx:e})},getAvatarPageUrl:function(){return be.urlService.getAbsoluteUrl("/my/avatar")},getPurchaseItemUrl:function(e){return d+"/v1/purchases/products/"+e},getItemDetailsUrl:function(e,t){return m+"/v1/catalog/items/"+e+"/details?itemType="+t},postItemDetailsUrl:function(){return m+"/v1/catalog/items/details"},getPurchaseableDetailUrl:function(e){return d+"/v1/products/"+e+"?showPurchasable=true"},getPremiumConversionUrl:function(e,t){return"/premium/membership?ctx=WebItemDetail&upsellTargetType="+t+"&upsellTargetId="+e},getResellerDataUrl:function(e){return d+"/v1/assets/"+e+"/resellers?limit=10"},getInventoryUrl:function(e){return"/users/"+e+"/inventory"},getMetaDataUrl:function(){return d+"/v2/metadata"},getCurrentUserBalance:function(e){return d+"/v1/users/"+e+"/currency"},getPurchaseCollectibleItemUrl:function(e){return p+"/marketplace-sales/v1/item/"+e+"/purchase-item"},getPurchaseCollectibleItemInstanceUrl:function(e){return p+"/marketplace-sales/v1/item/"+e+"/purchase-resale"},getCollectibleItemDetailsUrl:function(){return p+"/marketplace-items/v1/items/details"},getTwoStepVerificationConfig:function(e){return f+"/v1/users/"+e+"/configuration"},postGenerateTwoStepVerificationToken:function(e){return d+"/v2/"+e+"/two-step-verification/generate"},postRedeemTwoStepVerificationChallenge:function(e){return d+"/v2/"+e+"/two-step-verification/redeem"},postBulkPurchaseUrl:function(){return p+"/cloud/v2/avatar-marketplace-orders"},getVngShopUrl:function(){return p+"/vng-payments/v1/getVngShopUrl"},getVngShopFallbackUrl:function(){return y},getVngBuyRobuxBehaviorUrl:function(){return b+"/v1/behaviors/vng-buy-robux/content"},postPurchaseDeveloperProductUrl:function(e){return{url:p+"/developer-products/v1/developer-products/"+e+"/purchase?requestLocationType=ExperienceDetailPage",withCredentials:!0}}},g=a.resources;function h(e){var t=e.translate,r=e.price,n=e.color,e=e.useFreeText;return 0===r&&e?fe().createElement("span",{className:"text-robux text-free"},t(g.freeLabel)):fe().createElement(fe().Fragment,null,fe().createElement("span",{className:"icon-robux".concat(n?"-".concat(n):"","-16x16")}),fe().createElement("span",{className:"text-robux"},be.numberFormat.getNumberFormat(r)))}h.defaultProps={color:"",useFreeText:!0},h.propTypes={price:o().number.isRequired,translate:o().func.isRequired,color:o().string,useFreeText:o().bool};var A=(0,s.withTranslations)(h,l.purchasingResources);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E=a.resources;function R(){var e=S((0,T.createModal)(),2),i=e[0],e=e[1];function t(e){var t=e.translate,r=e.robuxNeeded,n=e.source,a=e.onAccept,r=fe().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:t(E.insufficientFundsMessage,{robux:(0,w.renderToString)(fe().createElement(A,{price:r}))})}});return fe().createElement(i,v({title:t(E.insufficientFundsHeading),body:r,thumbnail:fe().createElement("span",{className:"money-stack-icon"}),neutralButtonText:t(E.cancelAction),actionButtonText:t(E.buyRobuxAction),onAction:function(){return P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.ROBUX_UPSELL,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,P.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.BUY_ROBUX),a?a():window.location=x.getRobuxUpgradesUrl(n),!1},onClose:function(){P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.ROBUX_UPSELL,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,P.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.CANCEL)}},{actionButtonShow:!0}))}return t.defaultProps={onAccept:null,source:""},t.propTypes={translate:o().func.isRequired,source:o().string,onAccept:o().func,robuxNeeded:o().number.isRequired},[(0,s.withTranslations)(t,l.purchasingResources),e]}function ge(){var e=document.getElementById("ItemPurchaseAjaxData");return e?{userRobuxBalance:parseInt(e.getAttribute("data-user-balance-robux"),10),userBc:parseInt(e.getAttribute("data-user-bc"),10),hasCurrencyServiceError:"True"===e.getAttribute("data-has-currency-service-error"),currencyServiceErrorMessage:e.getAttribute("data-currency-service-error-message")}:{}}var M=a.resources;function N(e){var t=e.translate,r=e.expectedPrice,e=e.currentRobuxBalance,r=(null!=e?e:ge().userRobuxBalance)-r;return fe().createElement("span",{dangerouslySetInnerHTML:{__html:t(M.balanceAfterMessage,{robuxBalance:(0,w.renderToString)(fe().createElement(A,{price:r,color:"gray",useFreeText:!1}))})}})}N.propTypes={expectedPrice:o().number.isRequired,currentRobuxBalance:o().number,translate:o().func.isRequired},N.defaultProps={currentRobuxBalance:void 0};var C=(0,s.withTranslations)(N,l.purchasingResources);function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O=a.resources;function B(){var e=D((0,T.createModal)(),2),c=e[0],e=e[1];function t(e){var t=e.translate,r=e.expectedPrice,n=e.currentPrice,a=e.onAction,i=e.loading,e=D((0,pe.useState)(!1),2),o=e[0],s=e[1],r=fe().createElement(fe().Fragment,null,fe().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:t(O.priceChangedMessage,{robuxBefore:(0,w.renderToString)(fe().createElement(A,{price:r,color:"gray"})),robuxAfter:(0,w.renderToString)(fe().createElement(A,{price:n,color:"gray"}))})}}),fe().createElement("div",{className:"modal-checkbox checkbox"},fe().createElement("input",{id:"modal-checkbox-input",name:"agreementCheckBox",type:"checkbox",checked:o}),fe().createElement("label",{onClick:function(){return s(!o)},htmlFor:"modal-checkbox-input"},t(O.agreeAndPayLabel))));return fe().createElement(c,F({title:t(O.priceChangedHeading),body:r,neutralButtonText:t(O.cancelAction),actionButtonText:t(O.buyRobuxAction),onAction:a,loading:i,disableActionButton:!o,footerText:fe().createElement(C,{expectedPrice:n})},{actionButtonShow:!0}))}return t.defaultProps={loading:!1},t.propTypes={translate:o().func.isRequired,expectedPrice:o().number.isRequired,currentPrice:o().number.isRequired,onAction:o().func.isRequired,loading:o().bool},[(0,s.withTranslations)(t,l.purchasingResources),e]}function L(e){e=e.name;return fe().createElement("span",{className:"font-bold"},e)}L.propTypes={name:o().string.isRequired};var q=L;function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var H=a.resources;function V(){var e=_((0,T.createModal)(),2),p=e[0],e=e[1];function t(e){var t,r=e.translate,n=e.title,a=e.expectedPrice,i=e.thumbnail,o=e.assetName,s=e.assetType,c=e.assetTypeDisplayName,l=e.sellerName,u=e.isPlace,d=e.onAction,m=e.loading,e=e.currentRobuxBalance,c={assetName:(0,w.renderToString)(fe().createElement(q,{name:o})),assetType:c||s,seller:(0,be.escapeHtml)()(l),robux:(0,w.renderToString)(fe().createElement(A,{price:a}))},s=u?H.promptBuyAccessMessage:H.promptBuyMessage,l=0===a?(t=r(H.getItemHeading),r(H.getNowAction)):(t=r(H.buyItemHeading),r(H.buyNowAction));u&&(l=r(H.buyAccessAction));c=fe().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:r(s,c)}});return fe().createElement(p,k({title:n||t,body:c,thumbnail:i,neutralButtonText:r(H.cancelAction),actionButtonText:l,onAction:d,footerText:fe().createElement(C,{expectedPrice:a,currentRobuxBalance:e}),loading:m},{actionButtonShow:!0}))}return t.defaultProps={isPlace:!1,assetTypeDisplayName:"",title:"",loading:!1,currentRobuxBalance:void 0},t.propTypes={translate:o().func.isRequired,title:o().string,expectedPrice:o().number.isRequired,thumbnail:o().node.isRequired,assetName:o().string.isRequired,assetType:o().string.isRequired,assetTypeDisplayName:o().string,sellerName:o().string.isRequired,isPlace:o().bool,onAction:o().func.isRequired,loading:o().bool,currentRobuxBalance:o().number},[(0,s.withTranslations)(t,l.purchasingResources),e]}(Mt=Nt=Nt||{}).Bought="bought",Mt.Renewed="renewed";var G=Nt;function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var X=x.getAvatarPageUrl,$=a.resources;function he(){var e=W((0,T.createModal)(),2),h=e[0],e=e[1];function t(e){var t,r,n=e.translate,a=e.expectedPrice,i=e.thumbnail,o=e.assetName,s=e.assetType,c=e.assetIsWearable,l=e.assetTypeDisplayName,u=e.sellerName,d=e.isPlace,m=e.isPrivateServer,p=e.onAccept,f=e.onDecline,b=e.transactionVerb,y=e.itemDelayed,g=e.currentRobuxBalance,e=n($.continueAction);m?(t=n($.configureAction),e=n($.notNowAction)):y?(t=n($.customizeAction),e=n($.doneAction)):c&&(t=n($.customizeAction),e=n($.notNowAction),r=function(){return window.location.href=X(),!1});u={assetName:(0,w.renderToString)(fe().createElement(q,{name:o})),assetType:l||s,seller:(0,be.escapeHtml)()(u),robux:(0,w.renderToString)(fe().createElement(A,{price:a}))},d=b===G.Bought?d?$.successfullyAcquiredAccessMessage:$.successfullyBoughtMessage:b===G.Renewed?d?$.successfullyRenewedAccessMessage:$.successfullyRenewedMessage:d?$.successfullyAcquiredAccessMessage:$.successfullyAcquiredMessage,u=fe().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:"".concat(n(d,u)," ").concat(y?n($.itemGrantDelayMessage):"")}});return fe().createElement(h,{title:n($.purchaseCompleteHeading),body:u,thumbnail:i,neutralButtonText:e,actionButtonText:t,onAction:p||r,onNeutral:f,footerText:!m&&fe().createElement(C,{expectedPrice:a,currentRobuxBalance:g}),actionButtonShow:!!t,disableActionButton:y,onClose:function(){return window.location.reload()}})}return t.defaultProps={isPlace:!1,assetTypeDisplayName:"",transactionVerb:"",assetIsWearable:!1,isPrivateServer:!1,onAccept:null,onDecline:null,itemDelayed:!1,currentRobuxBalance:void 0},t.propTypes={translate:o().func.isRequired,transactionVerb:o().string,expectedPrice:o().number.isRequired,thumbnail:o().node.isRequired,assetName:o().string.isRequired,assetType:o().string.isRequired,assetTypeDisplayName:o().string,assetIsWearable:o().bool,sellerName:o().string.isRequired,isPlace:o().bool,isPrivateServer:o().bool,onAccept:o().func,onDecline:o().func,itemDelayed:o().bool,currentRobuxBalance:o().number},[(0,s.withTranslations)(t,l.purchasingResources),e]}var Q=x.getPurchaseItemUrl,Y=x.getPurchaseCollectibleItemUrl,K=x.getPurchaseCollectibleItemInstanceUrl,J=x.postBulkPurchaseUrl,Z=x.postPurchaseDeveloperProductUrl,ve={purchaseCollectibleItem:function(e,t){e={url:Y(e),retryable:!0,withCredentials:!0};return be.httpService.post(e,t)},purchaseCollectibleItemInstance:function(e,t){e={url:K(e),retryable:!0,withCredentials:!0};return be.httpService.post(e,t)},purchaseDeveloperProduct:function(e,t){e=Z(e.toString());return be.httpService.post(e,t)},purchaseItem:function(e,t){e={url:Q(e),retryable:!0,withCredentials:!0};return be.httpService.post(e,t)},bulkPurchaseItem:function(e,t,r,n){n={url:"".concat(J(),"?idempotencyKey.key=").concat(n),retryable:!0,withCredentials:!0},r={purchasingUser:"users/".concat(e),context:{productSurface:t},fulfillmentGroups:[r]};return be.httpService.post(n,r)}},ee=x.getItemDetailsUrl,te=(x.postItemDetailsUrl,x.getPurchaseableDetailUrl),re=x.getResellerDataUrl,ne=x.getMetaDataUrl,ae=(x.getCollectibleItemDetailsUrl,x.getCurrentUserBalance),ie=function(e,t){t={url:ee(e,t),retryable:!0,withCredentials:!0};return be.httpService.get(t)},oe=function(e){e={url:te(e),retryable:!0,withCredentials:!0};return be.httpService.get(e)},se=function(e){e={url:re(e),retryable:!0,withCredentials:!0};return be.httpService.get(e)},ce=function(){var e={url:ne(),retryable:!0,withCredentials:!0};return be.httpService.get(e)},Se=function(e){e={url:ae(e),retryable:!0,withCredentials:!0};return be.httpService.get(e)},le=function(e,o,s,c){return new(s=s||Promise)(function(r,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,a)}i((c=c.apply(e,o||[])).next())})},ue=function(r,n){var a,i,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},de=x.getTwoStepVerificationConfig,me=x.postGenerateTwoStepVerificationToken,Pe=x.postRedeemTwoStepVerificationChallenge,Ie=function(){return le(void 0,void 0,Promise,function(){var t;return ue(this,function(e){switch(e.label){case 0:t={url:me("spend-friction"),retryable:!0,withCredentials:!0},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.httpService.post(t)];case 2:return[2,e.sent().data||null];case 3:return e.sent(),[2,null];case 4:return[2]}})})},Ee=function(n,a){return le(void 0,void 0,Promise,function(){var t,r;return ue(this,function(e){switch(e.label){case 0:t={url:Pe("spend-friction"),retryable:!0,withCredentials:!0},r={challengeToken:n,verificationToken:a},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.httpService.post(t,r)];case 2:return r=e.sent(),[2,null!==(r=r.data)&&void 0!==r&&r];case 3:return e.sent(),[2,!1];case 4:return[2]}})})},we=function(e,o,s,c){return new(s=s||Promise)(function(r,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,a)}i((c=c.apply(e,o||[])).next())})},Ae=function(r,n){var a,i,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},Re=ye.AccountIntegrityChallengeService.TwoStepVerification;function Te(e){var t=e.systemFeedbackService,e=e.translate;t.warning(e("Response.VerificationError"))}function xe(e){var o=e.stopTwoStepVerification,s=e.systemFeedbackService,r=e.totalAttempts,c=e.translate;return we(this,void 0,void 0,function(){var i,t=this;return Ae(this,function(e){switch(e.label){case 0:return[4,Ie()];case 1:return(i=e.sent())?ye.AccountIntegrityChallengeService.TwoStepVerification.renderChallenge({containerId:"two-sv-popup-entry",userId:ye.CurrentUser.userId,challengeId:i,actionType:Re.ActionType.RobuxSpend,renderInline:!1,shouldShowRememberDeviceCheckbox:!1,onChallengeCompleted:function(a){return we(t,void 0,void 0,function(){var n;return Ae(this,function(e){switch(e.label){case 0:return[4,Ee(i,a.verificationToken)];case 1:return n=e.sent(),o(),n?(r=(t={systemFeedbackService:s,translate:c}).systemFeedbackService,t=t.translate,r.success(t("Response.SuccessfulVerificationV2"))):Te({systemFeedbackService:s,translate:c}),[2]}var t,r})})},onChallengeInvalidated:function(){var e=r||0;e<3?xe({stopTwoStepVerification:o,systemFeedbackService:s,translate:c,totalAttempts:e+1}):(Te({systemFeedbackService:s,translate:c}),o())},onModalChallengeAbandoned:function(){}}):Te({systemFeedbackService:s,translate:c}),[2]}})})}var Me=(0,s.withTranslations)(function(e){var t=this,r=e.translate,n=e.isTwoStepVerificationActive,a=e.stopTwoStepVerification,i=e.systemFeedbackService;return(0,pe.useEffect)(function(){n&&we(t,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,le(void 0,void 0,Promise,function(){var t;return ue(this,function(e){switch(e.label){case 0:t={url:de(ye.CurrentUser.userId),retryable:!0,withCredentials:!0},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,be.httpService.get(t)];case 2:return t=e.sent(),[2,((null===(t=null==t?void 0:t.data)||void 0===t?void 0:t.methods)||[]).some(function(e){return!!e.enabled})];case 3:return e.sent(),[2,!1];case 4:return[2]}})})];case 1:return e.sent()?xe({stopTwoStepVerification:a,systemFeedbackService:i,translate:r}):(t={titleText:(t=(t={translate:r}).translate)("Heading.TwoStepVerificationRequiredV3"),bodyContent:t("Message.TwoStepVerificationRequiredV4"),imageUrl:void 0,acceptText:t("Action.GoToSecurity"),acceptColor:"btn-primary-md",onAccept:function(){window.location.href=ye.Endpoints.getAbsoluteUrl("/my/account#!/security")},declineText:t("Action.Cancel"),dismissable:!0,allowHtmlContentInBody:!0,onOpenCallback:function(){}},ye.Dialog.open(t)),[2]}var t})})},[n]),fe().createElement("div",{id:"two-sv-popup-entry"})},l.purchasingResources);function Ne(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function Ce(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(a),!0).forEach(function(e){var t,r;t=n,e=a[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Ne(Object(a)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}function Fe(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Oe=a.resources,Be=a.errorTypeIds,Le=a.errorStatusText,qe=a.events;function ke(){function $(){me.itemDetail.buyButtonElementDataset&&(P.paymentFlowAnalyticsService.startRobuxUpsellFlow(me.itemDetail.buyButtonElementDataset.assetType,!!me.itemDetail.buyButtonElementDataset.userassetId,me.itemDetail.buyButtonElementDataset.isPrivateServer,me.itemDetail.buyButtonElementDataset.isPlace),t.open())}function Q(){var e,t,r;if(ye.ItemPurchaseUpsellService&&null!==(e=me)&&void 0!==e&&null!==(t=e.itemDetail)&&void 0!==t&&t.expectedItemPrice)if(0<=J-(null===me||void 0===me||null===(r=me.itemDetail)||void 0===r?void 0:r.expectedItemPrice))$();else try{ye.ItemPurchaseUpsellService.startItemUpsellProcess(me.errorObject,me.itemDetail,me.startOriginalFlowCallback),window.EventTracker.fireEvent(qe.NEW_UPSELL_FROM_REACT_BUY_BUTTON)}catch(e){window.EventTracker.fireEvent(qe.NEW_UPSELL_FAILED_DUE_TO_ERROR),$()}else window.EventTracker.fireEvent(qe.NEW_UPSELL_FAILED_DUE_TO_LOADING),$()}var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Y=e.customPurchaseVerificationModal,K=e.customPurchaseVerificationModalService,J=ge().userRobuxBalance,e=De((0,T.createSystemFeedback)(),2),Z=e[0],ee=e[1],e=De((0,T.createSystemFeedback)(),2),te=e[0],re=e[1],e=De(V(),2),ne=e[0],ae=e[1],e=De(R(),2),ie=e[0],t=e[1],e=De(he(),2),oe=e[0],se=e[1],e=De(B(),2),ce=e[0],le=e[1],e=De(u(),2),ue=e[0],de=e[1],me={errorObject:{},itemDetail:{},startOriginalFlowCallback:function(){return null}};function r(e){function c(){return _(!0)}var l=e.translate,i=e.assetName,o=e.assetType,s=e.assetTypeDisplayName,u=e.productId,d=e.expectedCurrency,t=e.expectedPrice,m=e.expectedSellerId,p=e.expectedPromoId,f=e.userAssetId,r=e.thumbnail,n=e.sellerName,b=e.sellerType,y=e.showSuccessBanner,g=e.isPlace,h=e.isPrivateServer,v=e.handlePurchase,S=e.onPurchaseSuccess,P=e.collectibleItemId,I=e.collectibleItemInstanceId,E=e.collectibleProductId,w=e.isLimited,a=e.customProps,A=e.saleLocationId,R=void 0===A?null:A,T=De((0,pe.useState)(!1),2),x=T[0],M=T[1],N=De((0,pe.useState)(null),2),C=N[0],F=N[1],D=De((0,pe.useState)(null),2),U=D[0],O=D[1],e=De((0,pe.useState)(t-J),2),A=e[0],B=e[1],T=De((0,pe.useState)(null),2),N=T[0],L=T[1],D=De((0,pe.useState)(void 0),2),e=D[0],q=D[1],T=De((0,pe.useState)(!1),2),k=T[0],_=T[1],D=De((0,pe.useState)(!1),2),T=D[0],j=D[1];(0,pe.useEffect)(function(){ye.CurrentUser.isAuthenticated&&void 0===ge().userRobuxBalance&&Se(ye.CurrentUser.userId).then(function(e){q(e.data.robux)}).catch(function(){q(void 0)})},[u,t,m]),(0,pe.useEffect)(function(){k&&j(!0)},[k]);function H(){(K||ae).close(),le.close()}function V(e,t){var r,n,a={assetType:o,assetTypeDisplayName:s,expectedCurrency:d,expectedPrice:t,expectedSellerId:m,itemName:i,itemType:o,productId:u,userassetId:f,placeproductpromotionId:p,isPrivateServer:h,isPlace:g,collectibleItemId:P,collectibleItemInstanceId:I,collectibleProductId:E};me={errorObject:{shortfallPrice:e,currentCurrency:d,isPlace:g},itemDetail:{expectedItemPrice:t,assetName:i,isLimited:w,buyButtonElementDataset:a},startOriginalFlowCallback:(r=e,n=a,function(){ye.ItemPurchaseUpsellService&&ye.ItemPurchaseUpsellService.showExceedLargestInsufficientRobuxModal?ye.ItemPurchaseUpsellService.showExceedLargestInsufficientRobuxModal(r,n,$):$()})}}function G(e){var t=e.showDivId,r=e.title,n=e.errorMsg,a=e.price,i=e.shortfallPrice,e=e.onDecline;t===Be.transactionFailure?(F({title:r,message:n,onDecline:e}),de.open()):t===Be.insufficientFunds?(B(i),V(i,a),Q()):t===Be.priceChanged&&(O(a),le.open())}function W(e){L(e),se.open()}function z(e){var t;P?X(e):"Product"===o?(t={expectedPrice:t=e,saleLocationType:"Website",saleLocationId:R},M(!0),ve.purchaseDeveloperProduct(u,t).then(function(e){e=e.data;e.purchased||"TwoStepVerificationRequired"!==e.reason?e.purchased?(S(),y?ee.success(l(Oe.purchaseCompleteHeading)):W({assetIsWearable:!1,transactionVerb:"",onDecline:function(){window.location.reload()}})):G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.generalPurchaseErrorMessage),showDivId:Be.transactionFailure}):c()}).catch(function(e){console.debug(e),M(!1),H();var t=null===(t=e.data)||void 0===t?void 0:t.errorCode;e&&500===e.status&&t===Be.pendingProductsLimitExceeded?G({title:l(Oe.pendingDeveloperProductLimitReachedHeading),errorMsg:l(Oe.pendingDeveloperProductLimitReachedMessage),showDivId:Be.transactionFailure}):e&&400!==(null==e?void 0:e.status)?429===e.status?G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.floodcheckFailureMessage,{throttleTime:1}),showDivId:Be.transactionFailure}):G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.generalPurchaseErrorMessage),showDivId:Be.transactionFailure}):G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.purchasingUnavailableMessage),showDivId:Be.transactionFailure})})):(e={expectedCurrency:d,expectedPrice:e=e,expectedSellerId:m},0<p&&(e.expectedPromoId=p),0<f&&(e.userAssetId=f),v?v({params:e,handleError:G,setLoading:M,openConfirmation:W,closeAll:H}):(M(!0),ve.purchaseItem(u,e).then(function(e){var t=e.data;console.debug(t);var r=t.statusCode,n=t.assetIsWearable,e=t.transactionVerb;M(!1),H(),t.purchased||"TwoStepVerificationRequired"!==t.reason?500===r?G(t):(S(),y?ee.success(l(Oe.purchaseCompleteHeading)):W({assetIsWearable:n,transactionVerb:e,onDecline:function(){window.location.reload()}})):c()}).catch(function(t){if(console.debug(t),M(!1),H(),t&&(null==t?void 0:t.statusText)!==Le.badRequest){429===t.status&&G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.floodcheckFailureMessage,{throttleTime:1}),showDivId:Be.transactionFailure});try{G(JSON.parse(null==t?void 0:t.statusText))}catch(e){G({errorMsg:null==t?void 0:t.statusText})}}else G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.purchasingUnavailableMessage),showDivId:Be.transactionFailure})})))}var X=function(){var s,e=(s=regeneratorRuntime.mark(function e(r){var n,a,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n={collectibleItemId:P,expectedCurrency:d,expectedPrice:r,expectedPurchaserId:ye.CurrentUser.userId,expectedPurchaserType:"User",expectedSellerId:m,expectedSellerType:b,idempotencyKey:be.uuidService.generateRandomUuid()},I&&(n.collectibleItemInstanceId=I),E&&(n.collectibleProductId=E),v)return v({params:n,handleError:G,setLoading:M,openConfirmation:W,closeAll:H}),t.abrupt("return");t.next=6;break;case 6:return M(!0),o=I?ve.purchaseCollectibleItemInstance:ve.purchaseCollectibleItem,t.prev=8,t.next=11,o(P,n);case 11:if(o=t.sent,a=o.data,i=a.transactionVerb,M(!1),H(),!("number"==typeof(o=null!==(o=a.statusCode)&&void 0!==o?o:a.status)&&400<=o||!1===(null==a?void 0:a.purchased))){t.next=21;break}!1===(null==a?void 0:a.purchased)&&"TwoStepVerificationRequired"===(null==a?void 0:a.reason)?c():!1===(null==a?void 0:a.purchased)&&"Flooded"===(null==a?void 0:a.purchaseResult)?G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.floodcheckFailureMessage,{throttleTime:1}),showDivId:Be.transactionFailure}):G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.purchasingUnavailableMessage),showDivId:Be.transactionFailure,onDecline:function(){window.location.reload()}}),t.next=26;break;case 21:if(S(),y)return ee.success(l(Oe.purchaseCompleteHeading)),t.abrupt("return");t.next=25;break;case 25:W({assetIsWearable:!0,transactionVerb:i,itemDelayed:null==a?void 0:a.pending,onDecline:function(){window.location.reload()}});case 26:t.next=37;break;case 28:if(t.prev=28,t.t0=t.catch(8),console.debug(t.t0),ye.AccountIntegrityChallengeService.Generic.ChallengeError.matchAbandoned(C))return M(!1),t.abrupt("return");t.next=34;break;case 34:if(M(!1),H(),t.t0&&(null===t.t0||void 0===t.t0?void 0:t.t0.statusText)!==Le.badRequest){429===t.t0.status&&G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.floodcheckFailureMessage,{throttleTime:1}),showDivId:Be.transactionFailure});try{G(JSON.parse(null===t.t0||void 0===t.t0?void 0:t.t0.statusText))}catch(e){G({errorMsg:null===t.t0||void 0===t.t0?void 0:t.t0.statusText})}}else G({title:l(Oe.errorOccuredHeading),errorMsg:l(Oe.purchasingUnavailableMessage),showDivId:Be.transactionFailure});case 37:case"end":return t.stop()}},e,null,[[8,28]])}),function(){var e=this,o=arguments;return new Promise(function(t,r){var n=s.apply(e,o);function a(e){Fe(n,t,r,a,i,"next",e)}function i(e){Fe(n,t,r,a,i,"throw",e)}a(void 0)})});return function(){return e.apply(this,arguments)}}(),a=Y?fe().createElement(Y,Ce({},Ce({assetName:i,assetType:o,expectedPrice:t,thumbnail:r,sellerName:n,loading:x,onAction:function(){return z(t)}},a))):fe().createElement(ne,{expectedPrice:t,thumbnail:r,assetName:i,assetType:o,assetTypeDisplayName:s,sellerName:n,isPlace:g,loading:x,collectibleItemId:P,collectibleItemInstanceId:I,currentRobuxBalance:e,onAction:function(){return z(t),!1}});return 0<A&&ye.ItemPurchaseUpsellService&&V(A,null!=U?U:t),fe().createElement(fe().Fragment,null,fe().createElement(Me,{isTwoStepVerificationActive:k,stopTwoStepVerification:function(){return _(!1)},systemFeedbackService:re}),0<A?fe().createElement(ie,{robuxNeeded:A}):a,C&&fe().createElement(ue,{title:C.title,message:C.message,onDecline:C.onDecline}),null!=U&&fe().createElement(ce,{expectedPrice:t,currentPrice:U,loading:x,onAction:function(){return z(U),!1}}),N&&fe().createElement(oe,Ce({thumbnail:r,assetName:i,assetType:o,assetTypeDisplayName:s,sellerName:n,isPlace:g,isPrivateServer:h,expectedPrice:U||t,currentRobuxBalance:e},N)),y&&fe().createElement(Z,null),T&&fe().createElement(te,null))}return r.defaultProps={isPlace:!1,isPrivateServer:!1,productId:null,assetTypeDisplayName:"",expectedPromoId:0,userAssetId:0,showSuccessBanner:!1,handlePurchase:null,onPurchaseSuccess:function(){return null},customProps:{},collectibleItemId:null,collectibleItemInstanceId:null,collectibleProductId:null,sellerType:null,isLimited:!1,saleLocationId:null},r.propTypes={translate:o().func.isRequired,productId:function(e,t,r){var n=e.collectibleItemId,a=e.productId;return n||"number"==typeof a?null:new Error("Invalid prop ".concat(t," supplied to ").concat(r,". Validation failed."))},expectedCurrency:o().number.isRequired,expectedPrice:o().number.isRequired,thumbnail:o().node.isRequired,assetName:o().string.isRequired,assetType:o().string.isRequired,assetTypeDisplayName:o().string,expectedSellerId:o().number.isRequired,sellerName:o().string.isRequired,sellerType:o().string,isPlace:o().bool,isPrivateServer:o().bool,expectedPromoId:o().number,userAssetId:o().number,showSuccessBanner:o().bool,handlePurchase:o().func,onPurchaseSuccess:o().func,customProps:o().func,collectibleItemId:o().string,collectibleItemInstanceId:o().string,collectibleProductId:o().string,isLimited:o().bool,saleLocationId:o().number},[(0,s.withTranslations)(r,l.purchasingResources),{start:function(){(K||ae).open(),Q()}}]}var _e=HeaderScripts;function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return He(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ve=a.errorMessages,Ge=function(e,t,r){function n(){o({loading:!1,loadFailure:!0})}var a=je((0,pe.useState)({expectedSellerId:0,owned:!1,isPurchasable:!1,id:0,itemType:"",assetType:"",name:"",description:"",productId:0,creatorTargetId:0,creatorName:"",price:null,loading:!0,loadFailure:!1,premiumPricing:null,premiumDiscountPercentage:null,hasLimitedPrivateSales:!1,isPublicDomain:!1,premiumPriceInRobux:null,assetTypeDisplayName:"",offSaleDeadline:null,unitsAvailableForConsumption:0,isLimited:!1,resellerAvailable:!1,firstReseller:{},priceStatus:"",isMarketPlaceEnabled:!0}),2),i=a[0],o=a[1],s=(0,pe.useCallback)(function(){e(t,r).then(function(e){var e=e.data,t={expectedSellerId:e.expectedSellerId,owned:e.owned,id:e.id,itemType:e.itemType,assetType:e.assetType,name:e.name,description:e.description,productId:e.productId,price:e.price,lowestPrice:e.lowestPrice,creatorTargetId:e.creatorTargetId,creatorName:e.creatorName,hasLimitedPrivateSales:void 0!==e.lowestPrice,isPublicDomain:0===e.price,offSaleDeadline:e.offSaleDeadline,isLimited:e.itemRestrictions.includes("Limited")||e.itemRestrictions.includes("LimitedUnique"),unitsAvailableForConsumption:void 0!==e.unitsAvailableForConsumption?e.unitsAvailableForConsumption:0,priceStatus:void 0!==e.priceStatus?e.priceStatus:"",itemRestrictions:e.itemRestrictions};void 0!==e.premiumPricing&&(t.premiumPriceInRobux=e.premiumPricing.premiumPriceInRobux,t.premiumDiscountPercentage=e.premiumPricing.premiumDiscountPercentage),t.isLimited&&(t.price=void 0!==t.lowestPrice?t.lowestPrice:t.price,se(t.id).then(function(e){t.resellerAvailable=0<e.data.data.length,t.resellerAvailable&&(e=je(e.data.data,1)[0],t.price=e.price,t.firstReseller=e)})),oe(e.productId).then(function(e){!e.data.purchasable&&e.data.reason&&e.data.reason!==Ve.insufficientFunds?t.isPurchasable=e.data.purchasable:t.isPurchasable=!0,t.assetTypeDisplayName=e.data.assetTypeDisplayName,t.loading=!1,t.loadFailure=!1,ce().then(function(e){t.isMarketPlaceEnabled=e.data.isMarketPlaceEnabled&&e.data.isItemsXchangeEnabled,o(t)}).catch(function(){n()})}).catch(function(e){e.statusText===Ve.unauthorizedMessage?(t.loading=!1,t.loadFailure=!1,o(t)):n()})}).catch(function(){n()})},[t,r,e]);return(0,pe.useEffect)(function(){s()},[]),{itemDetail:i,loadItemDetail:s}},We=function(){var e=document.getElementById("item-container");return e?{itemDetailItemId:parseInt(e.getAttribute("data-item-id"),10),itemDetailItemType:e.getAttribute("data-item-type")}:null},ze=RobloxThumbnails;function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $e=ke(),Qe=(Ct=(Ct=2,function(e){if(Array.isArray(e))return e}($e=$e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}($e,Ct)||function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xe(e,t)}($e,Ct)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))[0],Ye=Ct[1],Ke=a.resources,Je=x.getPremiumConversionUrl;function Ze(e){var t=e.translate,r=e.productId,n=e.price,a=e.itemName,i=e.itemType,o=e.assetTypeDisplayName,s=e.sellerName,c=e.expectedSellerId,l=e.isPurchasable,u=e.isOwned,d=e.isPlugin,m=e.itemDetailItemId,p=e.loading,f=e.userQualifiesForPremiumPrices,b=e.premiumPriceInRobux,y=e.isAuthenticated,g=e.resellerAvailable,h=e.firstReseller,g=e.isMarketPlaceEnabled&&(g||l),l=function(){return t(0===n?Ke.getAction:Ke.buyAction)};if(p)return fe().createElement(T.Loading,null);if(!y)return null!=b?fe().createElement(T.Button,{id:"upgrade-button",className:"btn-fixed-width-lg btn-primary-lg",onClick:function(){P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_PREMIUM_PURCHASE,!1,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.PREMIUM_UPSELL,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,P.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.GET_PREMIUM),window.open(Je(m,i))}},t(Ke.getPremiumAction)):fe().createElement(T.Button,{className:"btn-fixed-width-lg btn-growth-lg PurchaseButton",onClick:function(){window.location="/login"}},l());y=fe().createElement(ze.Thumbnail2d,{type:"bundle"===i?ze.ThumbnailTypes.bundleThumbnail:ze.ThumbnailTypes.assetThumbnail,size:ze.DefaultThumbnailSize,targetId:m,format:ze.ThumbnailFormat.webp,altName:a});return d&&(u||0===n)?fe().createElement(fe().Fragment,null,fe().createElement(T.Button,{className:"btn-fixed-width-lg btn-primary-lg InstallButton",onClick:function(){var e;e=m,ye.GameLauncher.openPluginInStudio(e)}},fe().createElement("span",null,t(Ke.installAction)))):fe().createElement(fe().Fragment,null,fe().createElement(T.Button,{className:"btn-fixed-width-lg btn-growth-lg PurchaseButton",onClick:Ye.start,isDisabled:!g},l()),fe().createElement(Qe,{productId:r,expectedPrice:f&&null!=b?b:n,thumbnail:y,assetTypeDisplayName:o,assetName:a,sellerName:h?h.seller.name:s,expectedSellerId:h?h.seller.id:c,userAssetId:h?h.userAssetId:0,showSuccessBanner:!0}))}Ze.propTypes={translate:o().func.isRequired,productId:o().number.isRequired,price:o().number.isRequired,itemName:o().string.isRequired,itemType:o().string.isRequired,assetTypeDisplayName:o().string.isRequired,sellerName:o().string.isRequired,expectedSellerId:o().number.isRequired,isPurchasable:o().bool.isRequired,isOwned:o().bool.isRequired,isPlugin:o().bool.isRequired,itemDetailItemId:o().number.isRequired,loading:o().bool.isRequired,userQualifiesForPremiumPrices:o().bool.isRequired,premiumPriceInRobux:o().number.isRequired,isAuthenticated:o().bool.isRequired,resellerAvailable:o().bool.isRequired,firstReseller:o().shape({seller:{name:o().string.isRequired,id:o().number.isRequired},userAssetId:o().number.isRequired}).isRequired,isMarketPlaceEnabled:o().bool.isRequired};var et=(0,s.withTranslations)(Ze,l.itemResources),tt=a.resources;function rt(e){var t=e.translate,r=e.isLimited,e=e.resellerAvailable,e=r&&e;return fe().createElement("div",{className:"text-label field-label price-label"},fe().createElement("span",null,t(e?tt.bestPriceLabel:tt.priceLabel)))}rt.propTypes={translate:o().func.isRequired,isLimited:o().bool.isRequired,resellerAvailable:o().bool.isRequired};var nt=(0,s.withTranslations)(rt,l.itemResources),at=a.resources,it=a.errorMessages,ot=x.getPremiumConversionUrl;function st(e){function t(e){P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_PREMIUM_PURCHASE,!1,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.PREMIUM_UPSELL,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,e.target.innerText)}var r=e.translate,n=e.price,a=e.itemType,i=e.itemDetailItemId,o=e.premiumPriceInRobux,s=e.premiumDiscountPercentage,c=e.userQualifiesForPremiumPrices,l=e.isOwned,u=e.loading,d=e.loadFailure,m=e.unitsAvailableForConsumption,p=e.isLimited,f=e.isPlugin,b=e.resellerAvailable,y=e.priceStatus,g=e.offSaleDeadline,h=e.isMarketPlaceEnabled,v=null==o&&null==n,S=!0,e="";return u?fe().createElement(T.Loading,null):(!u&&d?e=it.retryErrorMessage:y===at.offSale&&null===g?e=r(at.itemNoLongerForSaleLabel):h||l?f||!l||p?p&&0===m&&!b?e=r(at.noOneCurrentlySellingLabel):S=!1:e=r(at.itemAvailableInventoryLabel):e=r(at.purchasingTemporarilyUnavailableLabel),0===n?null:S&&!l?fe().createElement("div",{className:"price-container-text"},fe().createElement("div",{className:"item-first-line"}," ",e," ")):fe().createElement(fe().Fragment,null,fe().createElement("div",{className:"price-container-text"},S?fe().createElement("div",{className:"item-first-line"}," ",e," "):null,fe().createElement(nt,{translate:r,isLimited:p,resellerAvailable:b}),fe().createElement("div",{className:"price-info"},fe().createElement("div",{className:"icon-text-wrapper clearfix icon-robux-price-container"},v?fe().createElement("span",{className:"icon-robux-16x16 icon-robux-gray-16x16 wait-for-i18n-format-render"}):fe().createElement("span",{className:"icon-robux-16x16 wait-for-i18n-format-render"}),fe().createElement("span",{className:"text-robux-lg wait-for-i18n-format-render"},c&&null!=o?be.numberFormat.getNumberFormat(o):be.numberFormat.getNumberFormat(n)))),function(){if(null==o||l)return null;if(null==n)return c?fe().createElement("span",{className:"small text field-content empty-label wait-for-i18n-format-render"},r(at.premiumExclusiveEligiblePromptLabel)):fe().createElement("span",{className:"small text field-content empty-label wait-for-i18n-format-render"},r(at.premiumExclusiveIneligiblePromptLabel));var e={originalPrice:(0,w.renderToString)(fe().createElement(A,{price:n})),discountPercentage:s,premiumDiscountedPrice:(0,w.renderToString)(fe().createElement(A,{price:o}))};return fe().createElement(fe().Fragment,null,fe().createElement("div",{className:"text-label field-label empty-label"},""),fe().createElement("span",{className:"premium-prompt small text field-content empty-label wait-for-i18n-format-render"},c?fe().createElement("a",{"aria-label":" ",href:ot(i,a),dangerouslySetInnerHTML:{__html:r(at.premiumDiscountSavingsLabel,e)},onClick:function(e){t(e),window.open(ot(i,a))}}):fe().createElement("a",{"aria-label":" ",href:ot(i,a),dangerouslySetInnerHTML:{__html:r(at.premiumDiscountOpportunityPromptLabel,e)},onClick:function(e){t(e),window.open(ot(i,a))}})))}())))}st.propTypes={translate:o().func.isRequired,price:o().number.isRequired,itemType:o().string.isRequired,itemDetailItemId:o().number.isRequired,premiumPriceInRobux:o().number.isRequired,premiumDiscountPercentage:o().number.isRequired,userQualifiesForPremiumPrices:o().bool.isRequired,loading:o().bool.isRequired,isOwned:o().bool.isRequired,loadFailure:o().bool.isRequired,unitsAvailableForConsumption:o().number.isRequired,isLimited:o().bool.isRequired,isPlugin:o().bool.isRequired,resellerAvailable:o().bool.isRequired,priceStatus:o().string.isRequired,offSaleDeadline:o().string.isRequired,isMarketPlaceEnabled:o().bool.isRequired};var ct=(0,s.withTranslations)(st,l.itemModelResources);function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dt=a.resources;function mt(e){var t=e.translate,r=e.offSaleDeadline,e=lt((0,pe.useState)(0),2),n=e[0],a=e[1],e=lt((0,pe.useState)(0),2),i=e[0],o=e[1],e=lt((0,pe.useState)(0),2),s=e[0],c=e[1],e=lt((0,pe.useState)(0),2),l=e[0],u=e[1];(0,pe.useEffect)(function(){function e(){var e;new Date<new Date(r)&&(e=+new Date,e=(new Date(r).getTime()-e)/1e3,a(Math.floor(e/86400)),o(Math.floor(e/3600%24)),c(Math.floor(e/60%60)),u(Math.floor(e%60)))}var t;return e(),t=setInterval(e,1e3),function(){return clearInterval(t)}},[a,o,c,u]);return fe().createElement("div",{id:"sale-clock",className:"text-error sale-clock desktop-sale-clock"},function(){if(n<1){var e={numberOfHours:i,numberOfMinutes:s,numberOfSeconds:l};return fe().createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:t(dt.OffsaleCountdownHourMinuteSecondLabel,e)}})}if(l<1)return window.location.reload(),null;e={numberOfDays:n,numberOfHours:i,numberOfMinutes:s};return fe().createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:t(dt.CountdownTimerDayHourMinute,e)}})}())}mt.propTypes={translate:o().func.isRequired,offSaleDeadline:o().string.isRequired};var pt=(0,s.withTranslations)(mt,l.itemResources),ft=a.resources,bt=a.assetTypes,yt=a.assetCategory,gt=x.getInventoryUrl;function ht(e){var t=e.translate,r=e.assetType,n=_e.deviceMeta.getDeviceMeta(),a="phone"===n.deviceType,e=gt(_e.authenticatedUser.id),i=r===bt.Plugin||r===bt.Decal||r===bt.Model||r===bt.Video||r===bt.Animation?yt.Library:r===bt.Place||r===bt.Badge||r===bt.GamePass||r===bt.Animation?null:yt.Catalog;return i!==yt.Catalog||n.isInApp||!_e.deviceMeta.isAndroidApp&&!_e.deviceMeta.isIosApp||!_e.deviceMeta.isPhone&&!_e.deviceMeta.isTablet?i!==yt.Catalog||a?fe().createElement("a",{id:"inventory-button",href:e,className:"btn-fixed-width-lg btn-control-md"},t(ft.inventoryAction)):fe().createElement("a",{id:"edit-avatar-button",href:"/my/avatar",className:"btn-control-md"},fe().createElement("span",{className:"icon-nav-charactercustomizer"})):fe().createElement("a",{id:"open-in-avatar-editor-button",href:"/#",className:"btn-fixed-width-lg btn-control-md"},fe().createElement("span",{className:"icon-nav-charactercustomizer"}))}ht.propTypes={translate:o().func.isRequired,assetType:o().number.isRequired};var vt=(0,s.withTranslations)(ht,l.itemResources),St=We,Pt=a.assetTypes;function It(e){var t=e.translate,e=St(),r=e.itemDetailItemId,e=e.itemDetailItemType,n=Ge(ie,r,e).itemDetail;return fe().createElement(fe().Fragment,null,fe().createElement(ct,{translate:t,price:n.price,itemType:n.itemType,itemDetailItemId:r,premiumPriceInRobux:n.premiumPriceInRobux,premiumDiscountPercentage:n.premiumDiscountPercentage,userQualifiesForPremiumPrices:_e.authenticatedUser.isPremiumUser,isOwned:n.owned,loading:n.loading,loadFailure:n.loadFailure,unitsAvailableForConsumption:n.unitsAvailableForConsumption,isLimited:n.isLimited,isPlugin:n.assetType===Pt.Plugin,resellerAvailable:n.resellerAvailable,priceStatus:n.priceStatus,offSaleDeadline:n.offSaleDeadline,isMarketPlaceEnabled:n.isMarketPlaceEnabled}),!n.loadFailure&&(n.owned&&(!n.isLimited||0<n.unitsAvailableForConsumption)?fe().createElement("div",{className:"action-button"},fe().createElement(vt,{translate:t,assetType:n.assetType})):fe().createElement("div",{className:"action-button"},fe().createElement(et,{translate:t,productId:n.productId,price:n.price,itemType:n.itemType,assetTypeDisplayName:n.assetTypeDisplayName,itemName:n.name,sellerName:n.creatorName,expectedSellerId:n.expectedSellerId,isPurchasable:n.isPurchasable,isOwned:n.owned,isInstallable:n.assetType===Pt.Plugin,itemDetailItemId:r,loading:n.loading,hasLimitedPrivateSales:n.hasLimitedPrivateSales,userQualifiesForPremiumPrices:_e.authenticatedUser.isPremiumUser,premiumPriceInRobux:n.premiumPriceInRobux,isAuthenticated:_e.authenticatedUser.isAuthenticated,unitsAvailableForConsumption:n.unitsAvailableForConsumption,isLimited:n.isLimited,resellerAvailable:n.resellerAvailable,firstReseller:n.firstReseller,isMarketPlaceEnabled:n.isMarketPlaceEnabled}),null!==n.offSaleDeadline&&fe().createElement(pt,{translate:t,offSaleDeadline:n.offSaleDeadline}))))}It.propTypes={translate:o().func.isRequired};var Et=It;function wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return At(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rt(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function Tt(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(a),!0).forEach(function(e){var t,r;t=n,e=a[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Rt(Object(a)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}var xt,e=function(e,t){e=Tt(Tt({},e),{},{expectedSellerId:t.expectedSellerId,owned:t.owned,id:t.id,itemType:t.itemType,assetType:t.assetType,name:t.name,description:t.description,productId:t.productId,price:t.price,lowestPrice:t.lowestPrice,creatorTargetId:t.creatorTargetId,creatorName:t.creatorName,hasLimitedPrivateSales:void 0!==t.lowestPrice,isPublicDomain:0===t.price,offSaleDeadline:t.offSaleDeadline,isLimited:t.itemRestrictions.includes("Limited")||t.itemRestrictions.includes("LimitedUnique"),collectibleItemId:t.collectibleItemId,collectibleItemDetails:t.collectibleItemDetails,unitsAvailableForConsumption:void 0!==t.unitsAvailableForConsumption?t.unitsAvailableForConsumption:0,priceStatus:null!==(e=t.priceStatus)&&void 0!==e?e:t.priceStatus,itemRestrictions:t.itemRestrictions});return void 0!==t.premiumPricing&&(e.premiumPriceInRobux=t.premiumPricing.premiumPriceInRobux,e.premiumDiscountPercentage=t.premiumPricing.premiumDiscountPercentage),e.isLimited&&(e.price=void 0!==e.lowestPrice?e.lowestPrice:e.price),void 0!==e.collectibleItemId&&(e.resellerAvailable=t.hasResellers,e.isPurchasable=void 0!==t.lowestPrice,e.isMarketPlaceEnabled="ShopAndAllExperiences"===t.saleLocationType||"ShopOnly"===t.saleLocationType),e},Mt=function(e,t){e=Tt({},e);return e.resellerAvailable=0<t.data.data.length,e.resellerAvailable&&(t=wt(t.data.data,1)[0],e.price=t.price,e.firstReseller=t),e},Nt=function(e,t,r){var n=a.errorMessages,e=Tt({},e);return!t.purchasable&&t.reason&&t.reason!==n.insufficientFunds&&t.reason!==n.twoStepVerificationRequired?e.isPurchasable=t.purchasable:(!t.purchasable&&t.reason&&t.reason===n.twoStepVerificationRequired&&(e.twoStepVerificationRequired=!0),e.isPurchasable=!0),e.assetTypeDisplayName=t.assetTypeDisplayName,e.loading=!1,e.loadFailure=!1,e.isMarketPlaceEnabled=r.data.isMarketPlaceEnabled&&r.data.isItemsXchangeEnabled,e},Ct=function(e){e=Tt({},e);return e.isPurchasable=!1,e};(We=xt=xt||{}).Asset="asset",We.Bundle="bundle";var Ft=xt;function Dt(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function Ut(s){return function(){var e=this,o=arguments;return new Promise(function(t,r){var n=s.apply(e,o);function a(e){Dt(n,t,r,a,i,"next",e)}function i(e){Dt(n,t,r,a,i,"throw",e)}a(void 0)})}}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Lt=a.maxBatchLoadRetries,qt=e,kt=Mt,_t=Nt,jt=Ct,Ht=function(i){var a=(r=Ot((0,pe.useState)(),2))[0],t=r[1],e=Ot((0,pe.useState)([]),2),r=e[0],o=e[1],s=(e=Ot((0,pe.useState)({}),2))[0],c=e[1],n=0,l=function(){n<Lt?(b(),n+=1):o([{loading:!1,loadFailure:!0}])},u=(0,pe.useCallback)(function(){_e.authenticatedUser.isAuthenticated?ce().then(function(e){t(e)}).catch(function(){l()}):t({data:{isMarketplaceEnabled:!1,isItemsXchangeEnabled:!1}})},[]);function d(e){return m.apply(this,arguments)}function m(){return(m=Ut(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.inCache)return e.abrupt("return",s[t.itemType.toLowerCase()][t.id]);e.next=2;break;case 2:if((r=qt({},t)).isLimited)return e.prev=4,e.next=7,se(r.id);e.next=14;break;case 7:n=e.sent,r=kt(r,n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),r.resellerAvailable=!1;case 14:if(void 0===t.productId){e.next=24;break}if(!_e.authenticatedUser.isAuthenticated){e.next=23;break}if(void 0===r.collectibleItemId)return e.next=19,oe(t.productId);e.next=21;break;case 19:n=e.sent,r=_t(r,n.data,a);case 21:e.next=24;break;case 23:r=jt(r);case 24:return e.abrupt("return",r);case 25:case"end":return e.stop()}},e,null,[[4,11]])}))).apply(this,arguments)}function p(){return(p=Ut(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map(function(e){return d(e)}));case 3:r=e.sent,o(r),n=s,r.forEach(function(e){e.isLimited||s[e.itemType.toLowerCase()][e.id]||(n[e.itemType.toLowerCase()][e.id]=e)}),c(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),l();case 13:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function f(){return(f=Ut(regeneratorRuntime.mark(function e(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],i.forEach(function(e){void 0===s[e.itemType.toLowerCase()][e.id]&&t.push(e)}),0<t.length)return n=[],t.map(function(e){return n.push({itemType:e.itemType,id:e.id})}),e.next=7,ye.ItemDetailsHydrationService.getItemDetails(n,!1,!0);e.next=8;break;case 7:r=e.sent;case 8:return a=[],i.forEach(function(t){var e;void 0===s[t.itemType.toLowerCase()][t.id]?(e=r.find(function(e){return e.id===t.id&&e.itemType.toLowerCase()===t.itemType.toLowerCase()}))&&a.push(e):a.push({id:t.id,itemType:t.itemType,inCache:!0})}),e.abrupt("return",a);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var b=(0,pe.useCallback)(function(){(function(){return f.apply(this,arguments)})().then(function(e){try{!function(){p.apply(this,arguments)}(e)}catch(e){l()}}).catch(function(){l()})},[a,i,d]);return(0,pe.useEffect)(function(){var e={};e[Ft.Asset]={},e[Ft.Bundle]={},c(e),u()},[]),(0,pe.useEffect)(function(){void 0!==a&&b()},[a,i]),{itemDetails:r,batchLoadItemDetails:b}};(Ct=dr=dr||{}).Success="Success",Ct.AlreadyOwned="ALREADY_OWNED",Ct.InsufficientFunds="INSUFFICIENT_ROBUX",Ct.ExceptionOccured="INTERNAL",Ct.TooManyPurchases="QUOTA_EXCEEDED",Ct.CaughtError="CaughtError",Ct.PremiumNeeded="INSUFFICIENT_MEMBERSHIP",Ct.NoSellers="NOT_FOR_SALE",Ct.TwoStepVerificationRequired="TwoStepVerificationRequired",Ct.InExperienceOnly="PURCHASE_PLACE_INVALID";var Vt=dr;function Gt(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function Wt(s){return function(){var e=this,o=arguments;return new Promise(function(t,r){var n=s.apply(e,o);function a(e){Gt(n,t,r,a,i,"next",e)}function i(e){Gt(n,t,r,a,i,"throw",e)}a(void 0)})}}function zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $t=a.resources,Qt=a.batchBuyMaxThumbnails,Yt=a.purchaseMetadataKeys,Kt=a.floodcheckTime;function Jt(e){var t=e.itemsCount,r=e.item,n=e.index,a=r.name,e=t-Qt,n=Qt<t&&n===Qt-1;return fe().createElement("div",{className:"modal-multi-item-image-container"},fe().createElement(ze.Thumbnail2d,{type:r.itemType.toLowerCase()===Ft.Bundle?ze.ThumbnailTypes.bundleThumbnail:ze.ThumbnailTypes.assetThumbnail,size:ze.DefaultThumbnailSize,targetId:r.id,containerClass:"batch-buy-thumbnail",format:ze.ThumbnailFormat.webp,altName:a}),n&&fe().createElement("div",{className:"thumb-overlay"},fe().createElement("div",{className:"font-header-1"},"",e)))}function Zt(){return(Zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rr=a.resources,nr=x.getVngBuyRobuxBehaviorUrl,ar=function(){var e={url:nr(),retryable:!0,withCredentials:!0};return be.httpService.get(e)};function ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return or(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return or(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sr,cr=a.resources,lr=(Ct=ir(R(),2))[0],ur=Ct[1],dr=ir((sr=(Nt=zt((0,T.createModal)(),2))[0],Nt=Nt[1],fr.defaultProps={title:"",loading:!1},fr.propTypes={translate:o().func.isRequired,title:o().string,expectedTotalPrice:o().number.isRequired,currentRobuxBalance:o().number.isRequired,purchaseMetadata:o().instanceOf(Map).isRequired,itemDetails:o().arrayOf(o().shape({productId:o().number.isRequired,price:o().number.isRequired,itemName:o().string.isRequired,itemType:o().string.isRequired,assetTypeDisplayName:o().string.isRequired,sellerName:o().string.isRequired,expectedSellerId:o().number.isRequired,isPurchasable:o().bool.isRequired,isOwned:o().bool.isRequired,isPlugin:o().bool.isRequired,itemDetailItemId:o().number.isRequired,loading:o().bool.isRequired,userQualifiesForPremiumPrices:o().bool.isRequired,premiumPriceInRobux:o().number.isRequired,isAuthenticated:o().bool.isRequired,resellerAvailable:o().bool.isRequired,firstReseller:o().shape({seller:{name:o().string.isRequired,id:o().number.isRequired},userAssetId:o().number.isRequired}).isRequired,isMarketPlaceEnabled:o().bool.isRequired})).isRequired,onCancel:o().func.isRequired,onTransactionComplete:o().func.isRequired,onAction:o().func.isRequired,loading:o().bool,productSurface:o().string.isRequired,systemFeedbackService:o().func.isRequired},[(0,s.withTranslations)(fr,l.purchasingResources),Nt]),2),mr=dr[0],pr=dr[1];function fr(e){var t,r=e.translate,n=e.title,a=e.expectedTotalPrice,l=e.itemDetails,i=e.currentRobuxBalance,u=e.purchaseMetadata,o=e.onCancel,d=e.onTransactionComplete,s=e.onAction,c=e.loading,m=e.productSurface,p=e.systemFeedbackService,f=zt((0,pe.useState)(!1),2),b=f[0],y=f[1],g=function(){p.loading(r("Message.TwoStepVerificationBatchPurchase")),y(!0)},h=zt((0,pe.useState)(!1),2),v=h[0],S=h[1],P={itemCount:l.length,robux:(0,w.renderToString)(fe().createElement("span",{className:"robux-price"},fe().createElement(A,{price:a})))},e=$t.batchBuyPromptMessage,f=0===a?(t=r($t.getItemHeading),r($t.getNowAction)):(t=r($t.buyItemHeading),r($t.buyNowAction)),h=null==l?void 0:l.slice(0,Qt);function I(e){var t=function(e,t){var r=0,n=[];if(200===e.status){if(e.data.fulfillmentGroups[0].lineItems.forEach(function(t){var e;"SUCCEEDED"===t.status?r+=1:(e=n.find(function(e){return e.error===t.errorReason}))?e.count+=1:n.push({error:t.errorReason,count:1})}),r===e.data.fulfillmentGroups[0].lineItems.length)return{success:!0,message:$t.purchaseCompleteHeading};var a={error:"",count:0};if(n.forEach(function(e){e.count>a.count&&(a=e)}),0<r)switch(a.error){case Vt.AlreadyOwned:return{success:!1,message:$t.batchBuyPartialSuccessItemsOwnedFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.InsufficientFunds:return{success:!1,message:$t.batchBuyPartialSuccessInsufficientFundsFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.ExceptionOccured:return{success:!1,message:$t.batchBuyPartialSuccessNetworkErrorFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.TooManyPurchases:return{success:!1,message:$t.batchBuyPartialSuccessFloodcheckFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.PremiumNeeded:return{success:!1,message:$t.batchBuyPartialSuccessPremiumNeededFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.NoSellers:return{success:!1,message:$t.batchBuyPartialSuccessNoSellersFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};case Vt.InExperienceOnly:return{success:!1,message:$t.batchBuyPartialSuccessInExperienceOnlyFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}};default:return{success:!1,message:$t.batchBuyPartialSuccessGeneralFailureMessage,params:{itemCountSuccess:r,itemCountFailure:a.count}}}else switch(a.error){case Vt.AlreadyOwned:return{success:!1,message:$t.batchBuyItemsOwnedFailureMessage};case Vt.InsufficientFunds:return{success:!1,message:$t.insufficientFundsFailureMessage};case Vt.ExceptionOccured:return{success:!1,message:$t.networkErrroFailureMessage};case Vt.TooManyPurchases:return{success:!1,message:$t.floodcheckFailureMessage,params:{throttleTime:Kt}};case Vt.PremiumNeeded:return{success:!1,message:$t.premiumNeededFailureMessage};case Vt.NoSellers:return{success:!1,message:$t.noSellersFailureMessage};case Vt.InExperienceOnly:return{success:!1,message:$t.inExperienceOnlyFailureMessage};default:return{success:!1,message:$t.purchaseErrorFailureMessage}}}else if(403===e.status&&e.data.message.includes("2sv"))t();else if(400===e.status&&e.data.message.includes("InsufficientTotalBalance"))return{success:!1,message:$t.insufficientFundsFailureMessage};return{success:!1,message:$t.purchaseErrorFailureMessage}}(e,g),e=t.params?r(t.message,t.params):r(t.message);t.success?p.success(e):p.warning(e)}function E(){return(E=Wt(regeneratorRuntime.mark(function e(){var t,r,n,a,i,o,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={strategy:"BEST_EFFORT",lineItems:[]},r=[],n=[],l.forEach(function(e){var t={};void 0!==e.collectibleItemId?(!("ExperiencesDevApiOnly"!==e.collectibleItemDetails.saleLocationType&&(!e.itemRestrictions.includes("Collectible")||0<e.collectibleItemDetails.unitsAvailableForConsumption&&(!e.collectibleItemDetails.hasResellers||e.collectibleItemDetails.price<e.collectibleItemDetails.lowestResalePrice)))&&e.collectibleItemDetails.lowestAvailableResaleProductId?t.collectibleProductId=e.collectibleItemDetails.lowestAvailableResaleProductId:t.collectibleProductId=e.collectibleItemDetails.collectibleProductId,t.agreedPriceRobux=e.collectibleItemDetails.lowestPrice):void 0!==e.firstReseller?(t.limitedV1InstanceId="".concat(e.firstReseller.userAssetId),t.agreedPriceRobux=e.firstReseller.price):(t.virtualEconomyProductId="".concat(e.productId),t.agreedPriceRobux=e.premiumPriceInRobux&&_e.authenticatedUser.isPremiumUser?e.premiumPriceInRobux:e.price),r.push(t);t={data:{itemData:{},reason:""}};"Asset"===e.itemType?t.data.itemData.assetId=e.id:t.data.itemData.bundleId=e.id,n.push(t)}),t.lineItems=r,a=u.has(Yt.LookId)?u.get(Yt.LookId):"",i=be.uuidService.generateRandomUuid(),i=void 0!==a&&""!==a?"web_looks_purchase-".concat(a,"-").concat(i):i,e.prev=8,e.next=11,ve.bulkPurchaseItem(ye.CurrentUser.userId,m,t,i);case 11:o=e.sent,s=0,o.data.fulfillmentGroups[0].lineItems.forEach(function(e){n[s].data.reason="SUCCEEDED"===e.status?"Success":e.errorReason,s+=1}),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(8),o=e.t0,c=0,n.forEach(function(e){n[c].data.reason=o.data.message,c+=1});case 21:I(o),d(n);case 23:case"end":return e.stop()}},e,null,[[8,16]])}))).apply(this,arguments)}h=fe().createElement(pe.Fragment,null,fe().createElement("div",{className:"modal-message multi-item",dangerouslySetInnerHTML:{__html:r(e,P)}}),void 0!==l&&0<l.length&&fe().createElement("div",{className:"modal-multi-item-images-container"},h.map(function(e,t){return fe().createElement(Jt,{key:e.itemId,itemsCount:l.length,item:e,index:t})})));return fe().createElement(fe().Fragment,null,fe().createElement(Me,{isTwoStepVerificationActive:b,stopTwoStepVerification:function(){S(!0),y(!1)},systemFeedbackService:p}),fe().createElement(sr,{title:n||t,body:h,neutralButtonText:r($t.cancelAction),actionButtonText:f,onAction:function(){var t=!1;l.forEach(function(e){t=t||e.twoStepVerificationRequired}),t&&!v?g():(function(){E.apply(this,arguments)}(),s())},onNeutral:function(){o()},footerText:fe().createElement(C,{expectedPrice:a,currentRobuxBalance:i}),loading:c,actionButtonShow:l}))}var br,yr=(Ct=ir((br=(Nt=er((0,T.createModal)(),2))[0],Nt=Nt[1],hr.defaultProps={onContinueToPayment:null},hr.propTypes={translate:o().func.isRequired,onContinueToPayment:o().func},[(0,s.withTranslations)(hr,l.purchasingResources),Nt]),2))[0],gr=Ct[1];function hr(e){var t=e.translate,r=e.onContinueToPayment,e=t(rr.redirectToPartnerWebsiteMessage,{linebreak:"\n\n"})||"This purchase must be completed on our partners website. You will be returned to Roblox after the purchase is completed.\n\n Proceed to partner website for payment?",e=fe().createElement("p",{className:"modal-body"},e);return fe().createElement(br,Zt({title:t(rr.leavingRobloxHeading)||"Leaving Roblox",body:e,neutralButtonText:t(rr.cancelAction),actionButtonText:t(rr.continueToPaymentAction)||"Continue To Payment",onAction:function(){P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.LEAVE_ROBLOX_WARNING,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,P.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.CONTINUE_TO_VNG),r()},onClose:function(){P.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(P.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,P.paymentFlowAnalyticsService.ENUM_VIEW_NAME.LEAVE_ROBLOX_WARNING,P.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,P.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.CANCEL)}},{actionButtonShow:!0}))}function vr(e){var t=e.currentUserBalance,r=e.items,n=e.itemDetails,a=e.purchaseMetadata,i=e.onBuyButtonClick,o=e.onConfirm,s=e.onCancel,c=e.onTransactionComplete,l=e.productSurface,u=e.displayPriceOnButton,d=e.systemFeedbackService,m=e.translate,p=!1,f=0,b=0,y=[],g=ir((0,pe.useState)(!1),2),h=g[0],v=g[1],S=ir((0,pe.useState)(!1),2),P=S[0],I=S[1],e=ir((0,pe.useState)(null),2),g=e[0],E=e[1],S=ir((0,pe.useState)(null),2),e=S[0],w=S[1];(0,pe.useEffect)(function(){ar().then(function(e){e=e.data.shouldShowVng;I(e)}).catch(function(e){console.debug(e),I(!1)})},[]);if(!_e.authenticatedUser.isAuthenticated)return fe().createElement("div",{className:"sign-in"},fe().createElement(T.Button,{className:"action-button batch-buy-purchase-button sign-in-button",variant:T.Button.variants.growth,size:T.Button.sizes.large,onClick:function(){var e;window.location=(e={ReturnUrl:window.location.pathname},be.urlService.getUrlWithQueries("/login",e))}},m(cr.buyAction)));if(void 0===n||0<n.length&&n[0]&&n[0].loading||void 0===t)return fe().createElement("div",{className:"loading"},fe().createElement(T.Button,{className:"action-button batch-buy-purchase-button",variant:T.Button.variants.growth,size:T.Button.sizes.large,isDisabled:!0},fe().createElement(T.Loading,null)));if(0===n.length||n[0]&&n[0].loadFailure)return fe().createElement(T.Button,{className:"action-button batch-buy-purchase-button",variant:T.Button.variants.growth,size:T.Button.sizes.large,isDisabled:!0},u?fe().createElement("div",{className:"purchase-price"},fe().createElement("span",{className:"icon-robux-white-28x28"}),fe().createElement("span",{className:"purchase-price-text text-robux-lg"},be.numberFormat.getNumberFormat(f))):fe().createElement("div",null,m(cr.buyAction)));n.forEach(function(e){var t;(void 0!==(t=e).collectibleItemId?t.isMarketPlaceEnabled&&t.isPurchasable||t.resellerAvailable:t.isMarketPlaceEnabled&&(t.resellerAvailable||t.isPurchasable))&&(p=!0),void 0!==e.collectibleItemDetails?e.collectibleItemDetails.lowestPrice?f+=e.collectibleItemDetails.lowestPrice:e.collectibleItemId.price&&(f+=e.collectibleItemDetails.price):e.premiumPriceInRobux&&_e.authenticatedUser.isPremiumUser?b+=e.premiumPriceInRobux:e.lowestPrice?f+=e.lowestPrice:e.price&&(f+=e.price),e.resellerAvailable&&y.push(e)});var A=f+b-t,S=fe().createElement(T.Loading,null);h||(S=u?fe().createElement("div",{className:"purchase-price"},fe().createElement("span",{className:"icon-robux-white-28x28"}),fe().createElement("span",{className:"purchase-price-text text-robux-lg"},be.numberFormat.getNumberFormat(f))):fe().createElement("div",null,m(cr.buyAction)));var R=function(){P?gr.open():window.location=x.getRobuxUpgradesUrl("")};return fe().createElement(fe().Fragment,null,fe().createElement("div",null,fe().createElement(T.Button,{className:"action-button batch-buy-purchase-button",variant:T.Button.variants.growth,size:T.Button.sizes.large,onClick:function(){var e;0<A?(w(fe().createElement(lr,{robuxNeeded:A,onAccept:R})),ur.open()):(e=fe().createElement(mr,{title:m(cr.buyNowAction),expectedTotalPrice:f+b,items:r,purchaseMetadata:a,itemDetails:n,resaleItems:y,currentRobuxBalance:t,onCancel:function(){var e;null==pr||null!==(e=pr.close)&&void 0!==e&&e.call(pr),s()},onTransactionComplete:function(e){v(!1),c(e)},onAction:function(){var e;null==pr||null!==(e=pr.close)&&void 0!==e&&e.call(pr),v(!0),o()},loading:!1,productSurface:l,systemFeedbackService:d}),E(e),pr.open()),i()},isDisabled:!p},S)),0<A&&fe().createElement("div",{id:"insufficient-funds-modal"},e),P&&fe().createElement("div",{id:"leave-roblox-warning-modal"},fe().createElement(yr,{onContinueToPayment:function(){var e={url:x.getVngShopUrl(),withCredentials:!0};be.httpService.get(e).then(function(e){e=e.data.vngShopRedirectUrl;window.open(e,"_blank").focus()}).catch(function(){window.open(x.getVngShopFallbackUrl,"_blank").focus()}),gr.close()}})),fe().createElement("div",{id:"multi-item-purchase-modal"},g))}vr.propTypes={currentUserBalance:o().number.isRequired,items:o().arrayOf(o().shape({id:o().number.isRequired,itemType:o().string.isRequired})).isRequired,purchaseMetadata:o().instanceOf(Map).isRequired,itemDetails:o().arrayOf(o().shape({productId:o().number.isRequired,price:o().number.isRequired,itemName:o().string.isRequired,itemType:o().string.isRequired,assetTypeDisplayName:o().string.isRequired,sellerName:o().string.isRequired,expectedSellerId:o().number.isRequired,isPurchasable:o().bool.isRequired,isOwned:o().bool.isRequired,isPlugin:o().bool.isRequired,itemDetailItemId:o().number.isRequired,loading:o().bool.isRequired,loadFailure:o().bool,userQualifiesForPremiumPrices:o().bool.isRequired,premiumPriceInRobux:o().number,isAuthenticated:o().bool.isRequired,resellerAvailable:o().bool.isRequired,firstReseller:o().shape({seller:{name:o().string.isRequired,id:o().number.isRequired},userAssetId:o().number.isRequired}),isMarketPlaceEnabled:o().bool.isRequired})).isRequired,onBuyButtonClick:o().func.isRequired,onConfirm:o().func.isRequired,onCancel:o().func.isRequired,onTransactionComplete:o().func.isRequired,productSurface:o().string.isRequired,displayPriceOnButton:o().bool.isRequired,systemFeedbackService:o().func.isRequired,translate:o().func.isRequired};var Sr=(0,s.withTranslations)(vr,l.purchasingResources);function Pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ir(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ir(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Er(e){var t=e.items,r=e.purchaseMetadata,n=e.onBuyButtonClick,a=e.systemFeedbackService,i=e.onConfirm,o=e.onCancel,s=e.onTransactionComplete,c=e.productSurface,l=e.displayPriceOnButton,u=e.translate,d=Pr((0,pe.useState)(void 0),2),e=d[0],m=d[1];(0,pe.useEffect)(function(){_e.authenticatedUser.isAuthenticated&&Se(_e.authenticatedUser.id).then(function(e){m(e.data.robux)}).catch(function(){m(void 0)})},[]);d=Ht(t).itemDetails;return fe().createElement(Sr,{currentUserBalance:e,items:t,itemDetails:d,purchaseMetadata:r,systemFeedbackService:a,onBuyButtonClick:n,onConfirm:i,onCancel:o,onTransactionComplete:s,productSurface:c,displayPriceOnButton:l,translate:u})}Er.propTypes={items:o().arrayOf(o().object).isRequired,purchaseMetadata:o().instanceOf(Map).isRequired,onBuyButtonClick:o().func,onConfirm:o().func,onCancel:o().func,onTransactionComplete:o().func,systemFeedbackService:o().func.isRequired,productSurface:o().string,displayPriceOnButton:o().bool,translate:o().func.isRequired},Er.defaultProps={onBuyButtonClick:function(){},onConfirm:function(){},onCancel:function(){},onTransactionComplete:function(){},productSurface:"SHOPPING_CART_WEB",displayPriceOnButton:!1},dr=(0,s.withTranslations)(Er,l.purchasingResources),Ct=a.errorTypeIds,window.RobloxItemPurchase={createTransactionFailureModal:u,createInsufficientFundsModal:R,createPriceChangedModal:B,createPurchaseVerificationModal:V,createPurchaseConfirmationModal:he,createItemPurchase:ke,errorTypeIds:Ct,getMetaData:ge,BalanceAfterSaleText:C,PriceLabel:A,AssetName:q,TransactionVerb:G,BatchBuyPriceContainer:dr},(0,be.ready)(function(){var e=document.getElementById("display-price-container");e&&(0,t.render)(fe().createElement(Et,null),e)})}();
//# sourceMappingURL=https://js.rbxcdn.com/761f6ebac329a29070d623912a9df8ef-itemPurchase.bundle.min.js.map

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("ItemPurchase");